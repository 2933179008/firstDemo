<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tbl.modules.handheldInterface.dao.ReceiptDetailInterfaceDAO">

    <!--根据收货单详情id更新可拆分数量和可拆分重量-->
    <update id="updateSeparableAmountAndWeight">
        <foreach collection="detailList" item="detail" index="index" separator=";" open="" close="">
            update receipt_plan_detail set separable_amount=separable_amount-#{detail.inStorageAmount},separable_weight=separable_weight-#{detail.inStorageWeight}
            where id=#{detail.receiptPlanDetailId}
        </foreach>
    </update>

    <!--入库单详情插入数据-->
    <insert id="insertInstorageDetail">
        <foreach collection="detailList" item="detail" index="index" separator=";" open="" close="">
            insert into instorage_bill_detail(instorage_bill_id,material_code,material_name,unit,instorage_amount,separable_amount,instorage_weight,separable_weight)
            select #{detail.instorageBillId},material_code,material_name,unit,#{detail.inStorageAmount},#{detail.inStorageAmount},#{detail.inStorageWeight},#{detail.inStorageWeight}
            from receipt_plan_detail
            where id=#{detail.receiptPlanDetailId}
        </foreach>
    </insert>
</mapper>