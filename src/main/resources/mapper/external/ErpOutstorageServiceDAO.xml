<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tbl.modules.external.dao.ErpOutstorageServiceDAO">

    <!--获取对应的销毁出库的为未上传的订单的信息-->
    <select id="getDestoryOutstorage" resultType="java.util.Map">
        select id,outstorage_bill_code,material_type,bill_type from outstorage_bill where outstorage_bill_type = 4 and material_type = "0" and state = 5 and isupload = 0
    </select>

    <!--获取对应自采的越库出库的为未上传的订单的信息-->
    <select id="getCusCrossOutstorage" resultType="java.util.Map">
       select id from outstorage_bill
        where outstorage_bill_type = 2  and state = 5 and isupload = 0 and material_type="0"
    </select>

    <!--获取对应客供的越库出库的为未上传的订单的信息-->
    <select id="getCrossOutstorage" resultType="java.util.Map">
       select id from outstorage_bill
        where outstorage_bill_type = 2  and state = 5 and isupload = 0 and material_type="1"
    </select>

    <!--通过出库单的ID查询对应的详情数据-->
    <select id="getDetailList" resultType="java.util.Map">
        select material_code,material_name,batch_no,weight,product_data,position_code from outstorage_bill_detail where outstorage_bill_id = #{outStorageId}
    </select>

    <!--通过出库单的ID查询对应的详情数据-->
    <update id="updateOutstorageBillErpFlag">
        <foreach collection="list" item="instorage" index="index" separator=";" open="" close="">
            update outstorage_bill set isupload='1'
            where id=#{instorage.id}
        </foreach>
    </update>

    <!--获取对应的退货出库的为未上传的订单的信息-->
    <select id="getReturnList" resultType="java.util.Map">
        select id,outstorage_bill_code from outstorage_bill where outstorage_bill_type = 1 and state = 5 and material_type = 0 and isupload = 0
    </select>

    <!--获取对应的领料的为未上传的订单的信息-->
    <select id="getMaterialRequisition" resultType="java.util.Map">
        select id,outstorage_bill_code,material_type,spare_bill_code,customer_code,bill_type from outstorage_bill where outstorage_bill_type = 0 and state = 5 and isupload = 0 and material_type = #{type}
    </select>

</mapper>