<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tbl.modules.outstorage.dao.SpareBillDetailDAO">
    <!--通过备料单的ID获取对应的备料单的详情 -->
    <select id = "spareBillDetailList" resultType="com.tbl.modules.outstorage.entity.SpareBillDetailManagerVO">
        select material_code materialCode,position_code positionCode,send_amount sendAmount from spare_bill_detail where spare_bill_id=#{id}
    </select>

    <!--通过备料单的ID获取对应的备料单的详情 -->
    <select id = "spareDetailList" resultType="com.tbl.modules.outstorage.entity.SpareBillDetailManagerVO">
        select id,material_code materialCode,supplier_code supplierCode,position_code positionCode,used_amount usedAmount,send_amount sendAmount,
            quantity_ready quantityReady,surplus_amount surplusAmount,measurement_time measurementTime,user_amount userAmount,theory_amount theoryAmount,
            real_amount realAmount,difference,query_weight queryWeight,query_box queryBox,query_add queryAdd,add_amount addAmount,month,day,used_box usedBox,used_weight usedWeight
	    from spare_bill_detail where spare_bill_id=#{id} ORDER BY line
    </select>

    <select id = "updateDetail" resultType="java.lang.Object">
        update spare_bill_detail set send_amount = send_amount+#{amount} where material_code = #{materialCode} and spare_bill_id = (select id from spare_bill where spare_bill_code = #{spareBillId})
    </select>



</mapper>